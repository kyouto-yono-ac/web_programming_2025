# 第12回：データ可視化（グラフ作成）

## 🎯 学習目標

第11回で学んだデータ集計・ランキング結果を、**視覚的に美しく分かりやすいグラフ**で表現する技術を身につけます。

### 具体的な目標
1. **Streamlitの基本グラフ機能**を使った可視化
2. **Plotly Express**による高度でインタラクティブなグラフ作成
3. **複数国の時系列比較**グラフの実装
4. **総合ダッシュボード**の作成

## 📋 授業の流れ（90分）

### 1. 前回の復習とイントロダクション（10分）
- 第11回で学んだ集計・ランキングの復習
- なぜグラフが重要か？データ可視化の意義

### 2. Streamlitの基本グラフ機能（20分）
- `st.line_chart()` - 折れ線グラフ
- `st.bar_chart()` - 棒グラフ
- `st.area_chart()` - 面グラフ
- 第11回のランキング結果をグラフ化

### 3. Plotly Expressによる高度なグラフ（25分）
- `px.line()` - カスタマイズ可能な折れ線グラフ
- `px.bar()` - 詳細設定可能な棒グラフ
- `px.scatter()` - 散布図
- インタラクティブな機能（ズーム、パン、ホバー）

### 4. 複数国の時系列比較（20分）
- `st.multiselect`で複数国を選択
- 選択された国々の年別推移を同時表示
- 色分けによる区別と凡例表示

### 5. 総合演習：可視化ダッシュボード（10分）
- 様々なグラフタイプの組み合わせ
- ユーザーがグラフタイプを選択できる機能

### 6. まとめと次回予告（5分）

## 🛠️ 使用技術

### 新しく学ぶライブラリ
- **Plotly Express** (`px`) - 高度なグラフ作成
- **Plotly Graph Objects** (`go`) - 詳細なカスタマイズ

### 主要な関数・メソッド
- `st.line_chart()`, `st.bar_chart()`, `st.area_chart()`
- `px.line()`, `px.bar()`, `px.scatter()`, `px.pie()`
- `st.plotly_chart()` - Plotlyグラフの表示
- `st.multiselect()` - 複数選択UI

## 📊 作成予定のグラフ

### 1. 基本グラフ
- 年別総ビザ発行数の推移（折れ線）
- 国別ランキング（棒グラフ）
- 地域別分布（円グラフ）

### 2. 比較グラフ
- 複数国の年別推移比較
- 年度別・国別ヒートマップ
- 上位国の推移変化

### 3. インタラクティブグラフ
- ズーム・パン機能付き時系列
- ホバー情報表示
- 動的フィルタリング

## 💡 学習のポイント

### データ可視化の基本原則
1. **目的を明確に** - 何を伝えたいか
2. **適切なグラフタイプ** - データの性質に合わせて選択
3. **色使い** - 見やすく、意味のある色分け
4. **ラベル・タイトル** - 分かりやすい説明

### 技術的なポイント
- **データの前処理** - グラフ用のデータ整形
- **レスポンシブデザイン** - 画面サイズに応じた調整
- **パフォーマンス** - 大量データの効率的な処理

## 🎨 使用予定のグラフタイプ

| グラフタイプ | 用途 | 実装方法 |
|-------------|------|----------|
| 📈 折れ線グラフ | 時系列データの推移 | `st.line_chart()`, `px.line()` |
| 📊 棒グラフ | カテゴリ別の比較 | `st.bar_chart()`, `px.bar()` |
| 🥧 円グラフ | 構成比の表示 | `px.pie()` |
| 📉 面グラフ | 累積値の変化 | `st.area_chart()` |
| 🔍 散布図 | 2つの値の関係性 | `px.scatter()` |

## 🔧 実習環境

### Google Colab
- Plotlyの追加インストール：`!pip install plotly`
- Streamlitアプリの実行とテスト

### ローカル環境
```bash
pip install plotly
streamlit run app_visualization.py
```

## 📝 事前準備

### 必要な知識
- 第11回の内容（データ集計・ランキング）
- Pandasの基本操作
- Streamlitの基本的な使い方

### 準備するもの
- `visa_number_in_japan.csv` データファイル
- 第11回で作成したデータ集計コード

## 🎯 期待される成果物

### 基本課題
1. **年別推移グラフ** - 全体のビザ発行数推移
2. **国別ランキンググラフ** - 特定年の上位国
3. **複数国比較グラフ** - 選択した国々の比較

### 発展課題
1. **インタラクティブダッシュボード** - 様々なグラフを組み合わせ
2. **地域別分析グラフ** - 地域ごとの特徴を可視化
3. **トレンド分析** - 成長率や変化率のグラフ

## 📚 参考資料

### 公式ドキュメント
- [Streamlit Charts](https://docs.streamlit.io/library/api-reference/charts)
- [Plotly Express](https://plotly.com/python/plotly-express/)
- [Plotly Graph Objects](https://plotly.com/python/graph-objects/)

### 学習リソース
- データ可視化のベストプラクティス
- 色理論とアクセシビリティ
- インタラクティブデザインの原則 